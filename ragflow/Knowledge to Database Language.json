{"nodes":[{"data":{"form":{"prologue":"Hello, I am a database analysis expert, how can I help you?"},"label":"Begin","name":"begin"},"dragging":false,"id":"begin","measured":{"height":44,"width":200},"position":{"x":-1654,"y":144},"selected":false,"sourcePosition":"left","targetPosition":"right","type":"beginNode"},{"data":{"form":{},"label":"Answer","name":"User Input"},"dragging":false,"id":"Answer:DeepHorsesInvent","measured":{"height":44,"width":200},"position":{"x":-1248,"y":144},"selected":false,"sourcePosition":"right","targetPosition":"left","type":"logicNode"},{"data":{"form":{"cite":false,"frequencyPenaltyEnabled":true,"frequency_penalty":0.7,"llm_id":"gpt-4o@OpenAI","maxTokensEnabled":false,"max_tokens":256,"message_history_window_size":12,"parameter":"Precise","parameters":[],"presencePenaltyEnabled":true,"presence_penalty":0.4,"prompt":"### Role\nYou are an expert in transforming domain rules into Relational Algebra queries using the given database schema. Given the table structure and user input, generate a natural language-based relational algebra expression that accurately represents the user's request.\n\nThe user’s rules: {Answer:DeepHorsesInvent}\n\nContains details about available tables and their key fields.\n{Template:SourTramsTry}\n\n### Instruction\n- You need to output the relational algebra expression in human language.\n- You don't need to explain your answer, you just need to give the result.\n- If multiple different knowledge is involved, please list them in separate lines.\n\n### Example\n- User Input: A vessel having a draught of 15 meters or more shall be deemed to be a deep draught vessel, also written as DDV.\n- Expected Output: DDV means Selects mmsi, name, and draft fields from ship_ais, filtering for vessels with draft >= 15.","temperature":0.1,"temperatureEnabled":true,"topPEnabled":true,"top_p":0.3},"label":"Generate","name":"Generate Relational Algebra"},"dragging":false,"id":"Generate:ReadyClothsWatch","measured":{"height":102,"width":200},"position":{"x":-829.9500171967918,"y":-163.92270320935268},"selected":false,"sourcePosition":"right","targetPosition":"left","type":"generateNode"},{"data":{"form":{"content":"## **Available Tables and Fields**  \n### **1. Ship AIS Information**  \nYou should only use one ship information table based on user's question.\n- `ship_ais`: Stores **real-time** ship position data.  \n- `ship_ais_quarter`: Stores ship data for the **past 15 minutes** (10s intervals).  \n- `ship_ais_hive`: Stores **historical** ship data (10s intervals).  \n\n#### **Key Fields:**  \n- `mmsi` (string): **Unique ship ID**  \n- `latitude` / `longitude`: **Ship’s coordinates**  \n- `point` (spatial): `ST_Point(longitude, latitude)`  \n- `course`: **Ship course**  \n- `length`: **Ship length**  \n- `sog`: **Ship speed**  \n- `name`: **Ship name**  \n- `last_updated`: **Data timestamp**  \n- `eta`: **Estimated arrival time**  \n- `type`: **Ship type**  \n- `ptms_destination`: **Predicted destination**  \n- `draft`: **Ship draft**  \n\n---\n\n### **2. shp_data Table (Geographic Areas)**  \nStores different geofences such as **anchorages, fairways, pilot stations, and straits**.  \n#### **Key Fields:**  \n- `object_type`: **Geofence type** (`\"anchorage\"`, `\"fairway\"`, `\"pilot_boarding_ground\"`, `\"strait\"`)  \n- `object_name`: **Geofence name** (may have multiple areas)  \n- `geom`: **Spatial data type**  \n  - `POLYGON`: `fairway`, `anchorage`, `strait`  \n  - `POINT`: `pilot_boarding_ground`  \n\n---\n\n### **3. warn_single Table (Collision Warnings)**  \nFilters data based on `tcpa` and `dcpa` thresholds. If not specified, include **all** data.  \n#### **Key Fields:** \n- `ship1` / `ship2`: **MMSI of ships**  \n- `cpa1_lat`, `cpa1_lon`: **Ship 1’s location** during warning  \n- `cpa2_lat`, `cpa2_lon`: **Ship 2’s location** during warning  \n- `dcpa`: **Distance of closest approach**  \n- `tcpa`: **Time of closest approach**  \n- `dt`: **Report timestamp**  ","parameters":[]},"label":"Template","name":"Table Structure"},"dragging":false,"id":"Template:SourTramsTry","measured":{"height":76,"width":200},"position":{"x":-1154.4363602030721,"y":-146.05529157083097},"selected":false,"sourcePosition":"right","targetPosition":"left","type":"templateNode"}],"edges":[{"id":"xy-edge__begin-Answer:DeepHorsesInventc","markerEnd":"logo","source":"begin","style":{"stroke":"rgb(202 197 245)","strokeWidth":2},"target":"Answer:DeepHorsesInvent","targetHandle":"c","type":"buttonEdge","zIndex":1001},{"id":"xy-edge__Answer:DeepHorsesInventb-Template:SourTramsTryc","markerEnd":"logo","source":"Answer:DeepHorsesInvent","sourceHandle":"b","style":{"stroke":"rgb(202 197 245)","strokeWidth":2},"target":"Template:SourTramsTry","targetHandle":"c","type":"buttonEdge","zIndex":1001},{"id":"xy-edge__Template:SourTramsTryb-Generate:ReadyClothsWatchc","markerEnd":"logo","source":"Template:SourTramsTry","sourceHandle":"b","style":{"stroke":"rgb(202 197 245)","strokeWidth":2},"target":"Generate:ReadyClothsWatch","targetHandle":"c","type":"buttonEdge","zIndex":1001},{"id":"xy-edge__Generate:ReadyClothsWatchb-Answer:DeepHorsesInventb","markerEnd":"logo","source":"Generate:ReadyClothsWatch","sourceHandle":"b","style":{"stroke":"rgb(202 197 245)","strokeWidth":2},"target":"Answer:DeepHorsesInvent","targetHandle":"b","type":"buttonEdge","zIndex":1001}]}